%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% GetDP vs SmallFEM         %%
%% Vectorial EMDA: 4 domains %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

clear all;
close all;

getdp = ...
    [
        3.824942985020e+01
        2.682698877575e+01
        2.265556709760e+01
        4.426638046706e+00
        2.435874288896e+00
        1.496817676718e+00
        5.299382056234e-01
        3.863988661587e-01
        1.708919716825e-01
        1.181632888409e-01
        5.384821992090e-02
        3.494777208294e-02
        2.406800300737e-02
        1.619381322285e-02
        1.211355658280e-02
        7.684746150049e-03
        5.241177564506e-03
        3.698408814426e-03
        2.461005616355e-03
        1.783945715397e-03
        1.185506321488e-03
        8.728465967143e-04
        3.707238954836e-04
        2.398642562232e-04
        1.612658762221e-04
        1.097086366256e-04
        4.781372064940e-05
        3.079829219287e-05
        1.400534845114e-05
        9.548798448625e-06
        3.330051094847e-06
        2.252556178647e-06
        9.287225296540e-07
        5.950567680467e-07
        2.229922820772e-07
        1.406890467532e-07
        3.462143182374e-08
    ];

smallfem = ...
    [
        3.061127113676e+00
        2.181973437389e+00
        1.844275653443e+00
        3.570000816399e-01
        1.997580699382e-01
        1.219435303999e-01
        4.295683670799e-02
        3.128787640737e-02
        1.391083788024e-02
        9.630891981998e-03
        4.381815314486e-03
        2.849321002014e-03
        1.958073610488e-03
        1.320704647520e-03
        9.872984816422e-04
        6.290417300457e-04
        4.272315227498e-04
        3.005632359171e-04
        1.999835791550e-04
        1.452085515823e-04
        9.651674724202e-05
        7.106526321271e-05
        3.003134278758e-05
        1.943340368890e-05
        1.307997881198e-05
        8.888687138995e-06
        3.875372367021e-06
        2.498611970524e-06
        1.134990049636e-06
        7.741875481289e-07
        2.697925468709e-07
        1.822251952448e-07
        7.521095710661e-08
        4.822579453666e-08
        1.809454525876e-08
        1.143698424060e-08
        2.824398130881e-09
    ];

it = [1:size(smallfem, 1)];

semilogy(it, ...
         getdp,           '-o', 'linewidth', 3, ...
         smallfem,        '-o', 'linewidth', 3, ...
         getdp * sqrt(2), '--*', 'linewidth', 3);
legend({'GetDP', 'SmallFEM', 'GetDP * \sqrt{2}'});
title('Vectorial EMDA: 4 domains');
xlabel('Iteration');
ylabel('Residual');

print('vemda_dom_4.png');
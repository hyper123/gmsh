%%%%%%%%%%%%%%%%%%%%%%%
%% GetDP vs SmallFEM %%
%% OO2: 5 domains    %%
%%%%%%%%%%%%%%%%%%%%%%%

clear all;
close all;

getdp = ...
    [
        6.664206227028e+01
        4.400852039735e+01
        3.439942241516e+01
        3.014457552298e+01
        2.860451977958e+01
        2.768452094985e+01
        2.400426435859e+01
        2.130457357990e+01
        1.046810025772e+00
        4.081625245213e-01
        1.071320617419e-01
        5.449111669187e-02
        3.002919488903e-02
        2.256067720174e-02
        1.774865284289e-02
        1.408780981345e-02
        8.772103035566e-03
        6.112320882022e-03
        3.326466147644e-03
        1.935398289210e-03
        9.777130104577e-04
        5.394215321563e-04
        1.902509568229e-04
        1.133468405721e-04
        6.097362195585e-05
        3.938863602608e-05
        2.131997507850e-05
        1.211674373114e-05
        4.894993249590e-06
        2.675994682625e-06
        4.243284476276e-07
        2.168597073628e-07
        1.248336850492e-07
        9.457676431322e-08
        7.499008566900e-08
        6.074719226764e-08
    ];

smallfem = ...
    [
        2.413758714057e+01
        1.620907394337e+01
        1.249466313603e+01
        1.086394656120e+01
        1.041258715759e+01
        9.991345078630e+00
        9.797285839679e+00
        9.613753359544e+00
        1.299692340098e+00
        5.932109177157e-01
        1.344899894225e-01
        6.966577771435e-02
        2.737910029857e-02
        1.841551710828e-02
        1.376387862624e-02
        1.126870836627e-02
        8.970025694264e-03
        7.448358162931e-03
        6.073734142189e-03
        5.084546278916e-03
        3.091799407751e-03
        2.126689684731e-03
        9.207631546057e-04
        4.805649737095e-04
        1.759724500859e-04
        1.063046967081e-04
        5.015901500974e-05
        3.483606053865e-05
        2.088079948905e-05
        1.404075517897e-05
        6.997886341569e-06
        5.082734288386e-06
        2.656172781853e-06
        1.959220800819e-06
        1.247335842468e-06
        9.549592687556e-07
        7.376593138712e-07
        6.588261888983e-07
        5.555656163213e-07
        4.841701712324e-07
        3.190478386561e-07
        1.612398521618e-07
        6.519958209882e-08
        4.017298574262e-08
        2.275704726508e-08
    ];

it = [1:size(smallfem, 1)];

getdp(end:size(smallfem, 1)) = getdp(end);

semilogy(it, [getdp, smallfem], '-o');
legend({'GetDP', 'SmallFEM'});
title('OO2: 5 domains');
xlabel('Iteration');
ylabel('Residual');
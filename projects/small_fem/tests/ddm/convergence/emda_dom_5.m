%%%%%%%%%%%%%%%%%%%%%%%
%% GetDP vs SmallFEM %%
%% EMDA: 5 domains   %%
%%%%%%%%%%%%%%%%%%%%%%%

clear all;
close all;

getdp = ...
    [
        6.407776753433e+01
        4.543136671499e+01
        3.603638365047e+01
        3.063365646846e+01
        4.155975825576e+00
        2.956632939015e+00
        1.845226786099e+00
        1.457788436524e+00
        9.420675212841e-01
        7.473320274171e-01
        5.334697251170e-01
        4.356826498807e-01
        2.892420336587e-01
        2.314261933333e-01
        1.495996700987e-01
        1.186575482940e-01
        7.742373522831e-02
        6.180667653854e-02
        5.140134642754e-02
        4.499086669270e-02
        3.822626205805e-02
        3.374372408587e-02
        2.617890354281e-02
        2.215733240171e-02
        1.800866291485e-02
        1.559215018658e-02
        8.645147045829e-03
        6.660512912020e-03
        4.333878110607e-03
        3.452788265020e-03
        1.482787953404e-03
        1.100895390342e-03
        7.376272221461e-04
        5.926419587536e-04
        1.826555895739e-04
        1.316849252255e-04
        1.021738721414e-04
        8.646363948453e-05
        3.979304828788e-05
        2.976542830583e-05
        2.578640839058e-05
        2.304749540852e-05
        1.495992493784e-05
        1.195114560895e-05
        6.221751633910e-06
        4.725704339779e-06
        3.372001874808e-06
        2.761517624517e-06
        1.910307107140e-06
        1.547700794124e-06
        1.106839249958e-06
        9.070903571895e-07
        3.197464360578e-07
        2.337597219961e-07
        6.796362218094e-08
        4.928248702285e-08
    ];

smallfem = ...
    [
        2.413007746393e+01
        1.709932292650e+01
        1.342535204750e+01
        1.136878652063e+01
        8.204191770609e+00
        6.752090119138e+00
        4.106586289342e+00
        3.234168674017e+00
        9.837857476513e-01
        7.117173531766e-01
        2.890830580676e-01
        2.125104289820e-01
        1.295628937720e-01
        1.015705081441e-01
        7.262236990780e-02
        5.939027828644e-02
        4.136617539928e-02
        3.362320378251e-02
        2.199227470658e-02
        1.752790662517e-02
        1.339228041726e-02
        1.125562741242e-02
        7.483188544199e-03
        5.989077142678e-03
        5.347472594413e-03
        4.875765016230e-03
        4.223050599303e-03
        3.766094273522e-03
        3.081456303723e-03
        2.672041761498e-03
        2.092713705976e-03
        1.852267665443e-03
        1.448929627727e-03
        1.212117000782e-03
        1.083559167536e-03
        9.046527255825e-04
        7.857296423134e-04
        7.316832488078e-04
        6.723126855321e-04
        5.878210692010e-04
        4.673986606711e-04
        3.829551249027e-04
        2.613557439414e-04
        2.146018399632e-04
        1.248808879560e-04
        8.388285509413e-05
        7.168838085252e-05
        5.702128041445e-05
        4.210791393883e-05
        2.755208925581e-05
        1.374385288055e-05
        9.855345135914e-06
        6.386168356111e-06
        5.243675944994e-06
        3.485835095086e-06
        2.831205268110e-06
        2.355930827269e-06
        1.951253922043e-06
        1.394337997304e-06
        1.095326556826e-06
        8.790086081321e-07
        7.977992185921e-07
        7.185041407055e-07
        6.164066722779e-07
        5.068177910929e-07
        4.623430644751e-07
        4.074185465363e-07
        3.623577764552e-07
        2.887162600402e-07
        2.514820432572e-07
        1.998829676063e-07
        1.672386631256e-07
        1.209711557666e-07
        1.036093116572e-07
        7.869441904400e-08
        6.677252031975e-08
        5.251041115887e-08
        4.464736582025e-08
        3.560196732142e-08
        2.922086755817e-08
        1.933624799653e-08
    ];

it = [1:size(smallfem, 1)];

getdp(end:size(smallfem, 1)) = getdp(end);

semilogy(it, [getdp, smallfem], '-o', 'linewidth', 3);
legend({'GetDP', 'SmallFEM'});
title('EMDA: 5 domains');
xlabel('Iteration');
ylabel('Residual');

print('emda_dom_5.png');
%%%%%%%%%%%%%%%%%%%%%%%
%% GetDP vs SmallFEM %%
%% EMDA: 4 domains   %%
%%%%%%%%%%%%%%%%%%%%%%%

clear all;
close all;

getdp = ...
    [
        6.440283576083e+01
        4.516919599531e+01
        3.558730605737e+01
        5.476260163291e+00
        2.989868943615e+00
        1.914555390383e+00
        1.227779673884e+00
        1.005783504056e+00
        8.052518088430e-01
        6.680534092345e-01
        4.824882050401e-01
        3.692633020987e-01
        3.076075847501e-01
        2.369856897912e-01
        1.847992730586e-01
        1.548859871502e-01
        1.242434316976e-01
        1.047878605321e-01
        8.091896211551e-02
        6.903649795068e-02
        3.479895146751e-02
        2.375469951974e-02
        1.342274709755e-02
        1.029747197635e-02
        2.930565910038e-03
        2.097338354494e-03
        1.434591443052e-03
        1.108375466796e-03
        9.130953046911e-04
        7.141057432225e-04
        6.082163792613e-04
        4.246769429584e-04
        3.092269758199e-04
        2.533629247666e-04
        1.769716151381e-04
        1.271607343112e-04
        6.732352326334e-05
        5.094404393610e-05
        3.423064304564e-05
        2.691906386256e-05
        1.608566709188e-05
        1.157963972174e-05
        2.530030556351e-06
        1.808667690387e-06
        9.853700671163e-07
        7.535575493358e-07
        7.972146603600e-08
        5.648852976695e-08
    ];

smallfem = ...
    [
        2.306498057022e+01
        1.620834235219e+01
        1.332475940867e+01
        8.929531827115e+00
        6.829819607597e+00
        3.675549495862e+00
        1.243355202892e+00
        9.046780212524e-01
        4.354119633944e-01
        3.200691091705e-01
        2.127754359448e-01
        1.673690520938e-01
        1.397555287429e-01
        1.150315411963e-01
        9.142420189240e-02
        6.570163857727e-02
        4.552471103547e-02
        2.999875201041e-02
        2.418307269380e-02
        2.019580915342e-02
        1.709386069642e-02
        1.446398005597e-02
        9.998767243923e-03
        7.581754345753e-03
        4.978412745566e-03
        3.973179826819e-03
        2.139794162541e-03
        1.605833341461e-03
        7.254569200934e-04
        5.384413283152e-04
        2.702484323281e-04
        2.121516849373e-04
        1.604900841766e-04
        1.322913840213e-04
        9.977945028449e-05
        7.873950789484e-05
        5.104619256346e-05
        3.960258522882e-05
        2.741165096401e-05
        2.096950453037e-05
        1.600370310859e-05
        1.186031729226e-05
        1.035673691236e-05
        8.599142336448e-06
        6.634710125448e-06
        5.578105201875e-06
        4.496699159175e-06
        3.222599235310e-06
        1.583791593178e-06
        1.212713915659e-06
        6.011212163654e-07
        4.631412142759e-07
        3.810238853917e-07
        2.890350214562e-07
        1.955254191280e-07
        1.670715780716e-07
        1.327530523387e-07
        9.901223775986e-08
        7.291767734505e-08
        5.039923900101e-08
        3.718372836555e-08
        3.318840540404e-08
        2.709913743494e-08
        2.449539195418e-08
        2.118505885398e-08
    ];

it = [1:size(smallfem, 1)];

getdp(end:size(smallfem, 1)) = getdp(end);

semilogy(it, [getdp, smallfem], '-o', 'linewidth', 3);
legend({'GetDP', 'SmallFEM'});
title('EMDA: 4 domains');
xlabel('Iteration');
ylabel('Residual');

print('emda_dom_4.png');
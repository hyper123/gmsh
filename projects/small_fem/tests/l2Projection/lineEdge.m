close all;
clear all;

h = [1, 0.5, 0.25, 0.125, 0.0625];
p = [1:4];

l2 = ...
    [...
        +1.131157e+00 , +6.525446e-01 , +2.322987e-01 , +5.779563e-02 , +1.457881e-02 ; ...
        +1.075659e+00 , +3.259000e-01 , +4.009796e-02 , +5.697928e-03 , +7.230599e-04 ; ...
        +7.064195e-01 , +8.558323e-02 , +7.916540e-03 , +4.836531e-04 , +3.047550e-05 ; ...
        +5.071560e-01 , +2.786054e-02 , +7.985148e-04 , +2.830611e-05 , +8.941516e-07 ; ...
    ];

P = size(p, 2);
H = size(h, 2);

delta = zeros(P, H - 1);

for i = 1:H-1
  delta(:, i) = ...
    (log10(l2(:, i + 1)) - log10(l2(:, i))) / ...
    (log10(1/h(i + 1))   - log10(1/h(i)));
end

delta

figure;
loglog(1./h, l2', '-*');
grid;
title('lin: Edge');

xlabel('1/h [-]');
ylabel('L2 Error [-]');
